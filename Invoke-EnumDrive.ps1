function Invoke-EnumDrive
{
    <#
    .DESCRIPTION
        
        Enumerate users via onedrive.
        Author: g0ttfrid

    .EXAMPLE
        
        PS C:\> Invoke-EnumDrive -method recon -domain domain.com.br

        Search tenant.

    .EXAMPLE

        PS C:\> Invoke-EnumDrive -method enum -tenant domain -file D:\users.txt

        Enumerate users.
    #>

    [CmdletBinding()]
    Param (
        [Parameter(Mandatory=$false)][string]$method,
        [Parameter(Mandatory=$false)][string]$domain,
        [Parameter(Mandatory=$false)][string]$tenant,
        [Parameter(Mandatory=$false)][string]$file
    )
    
    $a=New-Object IO.MemoryStream(,[Convert]::FromBAsE64String("H4"+"sI"+"AAAA"+"AAA"+"EAO"+"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"))
    $b = New-Object IO.Compression.GzipStream($a,[IO.Compression.CoMPressionMode]::DEComPress)
    $c = New-Object System.IO.MemoryStream
    $b.CopyTo( $c )
    [byte[]] $d = $c.ToArray()
    $e = [System.Reflection.Assembly]::Load($d)

    if ($method -eq "recon")
    {
        [EnumDrive.Program]::Main(@($method, $domain)) | Out-Null
    }
    elseif ($method -eq "enum")
    {
        [EnumDrive.Program]::Main(@($method, $tenant, $file)) | Out-Null
    }
    else 
    {
        Write-Host "[!] Invalid args"
        Write-Host "[!] Use for get tenant: Invoke-EnumDrive -method recon -domain domain.com.br"
        Write-Host "[!] Use for enum valid users: Invoke-EnumDrive -method enum -tenant domain -file D:\users.txt"
        return
    }
}
